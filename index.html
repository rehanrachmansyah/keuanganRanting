<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Kas Organisasi</title>
</head>
<body>
  <h2>Setor Kas</h2>

  <form id="kasForm">
    <div id="anggotaList">
      <label><input type="checkbox" name="anggota" value="Rehan"> Rehan</label><br>
      <label><input type="checkbox" name="anggota" value="Budi"> Budi</label><br>
      <label><input type="checkbox" name="anggota" value="Sinta"> Sinta</label><br>
      <label><input type="checkbox" name="anggota" value="Dewi"> Dewi</label><br>
    </div>

    <button type="submit">Kirim</button>
  </form>

  <hr>

  <h3>Tambah Anggota Baru</h3>
  <input type="text" id="namaBaru" placeholder="Nama baru">
  <button id="tambahBtn">Tambah</button>

  <script>
    const anggotaList = document.getElementById("anggotaList");

    // Tambahkan anggota baru di tampilan
    document.getElementById("tambahBtn").addEventListener("click", async () => {
      const nama = document.getElementById("namaBaru").value.trim();
      if (!nama) return alert("Masukkan nama!");

      // Tambah ke interface
      const label = document.createElement("label");
      label.innerHTML = `<input type="checkbox" name="anggota" value="${nama}"> ${nama}`;
      anggotaList.appendChild(label);
      anggotaList.appendChild(document.createElement("br"));

      // Kirim nama baru ke n8n
      await fetch("https://n8n.gitstraining.com/webhook/552443c9-6480-4bad-b7a1-f9f2301b7149", {
        method: "POST",
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify({ namaBaru: nama })
      });

      alert(`Anggota ${nama} ditambahkan!`);
      document.getElementById("namaBaru").value = "";
    });

    // Kirim daftar yang dicentang
    document.getElementById("kasForm").addEventListener("submit", async (e) => {
      e.preventDefault();
      const data = new FormData(e.target);
      const anggota = data.getAll("anggota");

      await fetch("https://n8n.gitstraining.com/webhook/552443c9-6480-4bad-b7a1-f9f2301b7149", {
        method: "POST",
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify({ anggota })
      });

      alert("Data kas berhasil dikirim!");
      e.target.reset();
    });
  </script>
</body>
</html>
